<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head lang="en">
<meta charset="UTF-8">
<title>Results</title>

<!-- build:css styles/main.css -->
<link rel="stylesheet" href="/css/bootstrap.css">
<link rel="stylesheet" href="/css/global.css">
<!-- endbuild -->

</head>
<body>
<style>
      html, body, #map-canvas {
        height: 100%;
        margin: 0px;
        padding: 0px
      }
      #panel {
        position: absolute;
        top: 5px;
        left: 50%;
        margin-left: -180px;
        z-index: 5;
        background-color: #fff;
        padding: 5px;
        border: 1px solid #999;
      }
    </style>
	<script
		src="https://maps.googleapis.com/maps/api/js?v=3.exp&amp;libraries=visualization"
		type="text/javascript"></script>
	<script th:inline="javascript" type="text/javascript">
/*<![CDATA[*/
           var ratingData = [];
           var map = /*[[${map.rawMap}]]*/ null;
           for (var i = 0; i < map.length; ++i) {
        	   for (var j = 0; j < map[i].length; j++) {
        		   /*var dataPoint = {location: new google.maps.LatLng(map[i][j].location.latitude, map[i][j].location.longitude), weight: map[i][j].rating};*/
        		   var dataPoint = {location: new google.maps.LatLng(map[i][j].location.latitude, map[i][j].location.longitude), weight: map[i][j].medianAge/200};
        		   ratingData.push(dataPoint);
        	   }
           }

           function initialize() {
			var center = map[Math.floor(map.length/2)][Math.floor(map.length/2)].location;
        	 var mapOptions = {
        	     zoom: 13,
        	     center: new google.maps.LatLng(center.latitude, center.longitude),
        	     mapTypeId: google.maps.MapTypeId.SATELLITE
        	 };

        	   map = new google.maps.Map(document.getElementById('map-canvas'),
        	       mapOptions);

        	   var pointArray = new google.maps.MVCArray(ratingData);

        	   heatmap = new google.maps.visualization.HeatmapLayer({
        	     data: pointArray,
        	     radius: 200,
        	     opacity: 0.3
        	   });
        	   
        	   heatmap.setMap(map);
        	 }

        	 function toggleHeatmap() {
        	   heatmap.setMap(heatmap.getMap() ? null : map);
        	 }

        	 function changeGradient() {
        	   var gradient = [
        	     'rgba(0, 255, 255, 0)',
        	     'rgba(0, 255, 255, 1)',
        	     'rgba(0, 191, 255, 1)',
        	     'rgba(0, 127, 255, 1)',
        	     'rgba(0, 63, 255, 1)',
        	     'rgba(0, 0, 255, 1)',
        	     'rgba(0, 0, 223, 1)',
        	     'rgba(0, 0, 191, 1)',
        	     'rgba(0, 0, 159, 1)',
        	     'rgba(0, 0, 127, 1)',
        	     'rgba(63, 0, 91, 1)',
        	     'rgba(127, 0, 63, 1)',
        	     'rgba(191, 0, 31, 1)',
        	     'rgba(255, 0, 0, 1)'
        	   ]
        	   heatmap.set('gradient', heatmap.get('gradient') ? null : gradient);
        	 }

        	 function changeRadius() {
        	   heatmap.set('radius', heatmap.get('radius') ? null : 20);
        	 }

        	 function changeOpacity() {
        	   heatmap.set('opacity', heatmap.get('opacity') ? null : 0.2);
        	 }
        	 
        	 google.maps.event.addDomListener(window, 'load', initialize);
/*]]>*/
</script>

	<div id="map-canvas"></div>

	<!--
<h1>Results</h1>
<h2>Census API Data</h2>
<div th:each="mapList : ${map}">
    <div th:each="zone : ${mapList}">
            <p th:text="'Rating: ' + ${zone.rating}" />
            <p th:text="'Median Income: $' + ${zone.medianIncome}" />
<p th:text="'Median Age: ' + ${zone.medianAge}" />
<p th:text="'Number of Singles: ' + ${zone.numSingle}" />
<p th:text="'Number Married: ' + ${zone.numMarried}" />
<br/><br/>
    </div>
</div>
-->
</body>
</html>